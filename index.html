<!DOCTYPE html>
<html lang="zh-CN">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>2035 æœªæ¥å‡ºè¡Œ</title>
<style>
  :root{
    --ink:#0a0f1c; /* HUD é’é»‘ */
    --glow:#00ffd0; /* HUD é’ç»¿ */
    --text:#0b1220; /* æ·±ç°æ–‡æœ¬ */
  }
  *{box-sizing:border-box}
  body{margin:0;background:#0a0f1c;position:relative;overflow-x:hidden;}
  /* æ·±ç©º + HUD ç²’å­èƒŒæ™¯ */
  body::before{content:"";position:fixed;inset:0;
    background:radial-gradient(circle at 50% 40%, rgba(0,255,200,0.15), transparent 60%),
               radial-gradient(circle at 30% 80%, rgba(0,100,255,0.12), transparent 55%),
               #0a0f1c;
    z-index:-3;
  }
  body::after{content:"";position:fixed;inset:0;pointer-events:none;
    background-image:
      linear-gradient(rgba(0,255,200,0.08) 1px,transparent 1px),
      linear-gradient(90deg,rgba(0,255,200,0.08) 1px,transparent 1px);
    background-size:80px 80px;
    opacity:.08;z-index:-2;
  }
  .stars-layer{position:fixed;inset:0;pointer-events:none;z-index:-1;
    background-image:radial-gradient(2px 2px at 20% 30%,rgba(255,255,255,.4),rgba(255,255,255,0)),
                     radial-gradient(1.5px 1.5px at 70% 60%,rgba(255,255,255,.3),rgba(255,255,255,0)),
                     radial-gradient(1.2px 1.2px at 40% 80%,rgba(255,255,255,.25),rgba(255,255,255,0));
    animation:floatStars 20s linear infinite alternate;
  }
  @keyframes floatStars{from{transform:translateY(0);}to{transform:translateY(-40px);} }
  .grid:before{content:"";position:absolute;inset:0;background-image:linear-gradient(rgba(0,0,0,0.04) 1px,transparent 1px),linear-gradient(90deg,rgba(0,0,0,0.04) 1px,transparent 1px);background-size:24px 24px;mask-image:radial-gradient(closest-side at 50% 40%,rgba(255,255,255,1),rgba(255,255,255,0.2));}
  .stars:after{content:"";position:absolute;inset:0;background-image:radial-gradient(2px 2px at 20% 30%, rgba(0,0,0,0.08), transparent),radial-gradient(1.5px 1.5px at 70% 60%, rgba(0,0,0,0.08), transparent),radial-gradient(1.5px 1.5px at 40% 80%, rgba(0,0,0,0.08), transparent);}  

  .wrap{max-width:560px;margin:0 auto;padding:28px 18px 80px;}
  header{display:flex;align-items:center;gap:10px;margin:8px 0 16px 0}
  .dot{width:10px;height:10px;border-radius:50%;background:var(--glow);box-shadow:0 0 12px var(--glow);} 
  h1{font-size:22px;margin:0;font-weight:700}
  .card{background:#fff;border-radius:18px;box-shadow:0 8px 30px rgba(20,40,120,.08);padding:22px 18px;margin:14px 0;}
  .q{font-size:18px;line-height:1.6;margin-bottom:14px}
  .hint{opacity:.7;font-size:13px;margin-top:6px}
  .options{display:flex;flex-direction:column;gap:10px}
  button,opt-btn{font:inherit}
  .chip{padding:12px 14px;border:1px solid rgba(0,0,0,.08);border-radius:12px;background:#fff;cursor:pointer;display:flex;justify-content:space-between;align-items:center;}
  .chip:hover{border-color:rgba(0,0,0,.2)}
  .chip.sel{border-color:var(--glow);box-shadow:0 0 0 3px rgba(0,255,208,.18);} 
  .actions{display:flex;gap:10px;margin-top:14px}
  .btn{padding:12px 16px;border-radius:12px;border:1px solid rgba(0,0,0,.08);background:#fff;cursor:pointer}
  .btn.primary{border-color:var(--glow);background:linear-gradient(180deg,#e9fffb,#dffdf6);box-shadow:0 8px 20px rgba(0,255,208,.22)}
  .progress{height:6px;background:#eef2f8;border-radius:999px;overflow:hidden;margin:12px 0 8px}
  .bar{height:100%;background:linear-gradient(90deg,var(--glow),#59f);width:0%;transition:width .25s ease}
  .foot{position:fixed;left:0;right:0;bottom:0;background:#fff6;border-top:1px solid #e6ecf5;backdrop-filter:saturate(120%) blur(8px);padding:10px 14px}
  .muted{opacity:.6}

  /* äººæ ¼å¡ */
  .card-result{background:#0b1220;color:#e6f7ff;border-radius:18px;padding:18px;box-shadow:0 12px 24px rgba(6,10,30,.35);}
  .badge{display:inline-block;padding:6px 10px;border:1px solid rgba(0,255,208,.5);border-radius:999px;margin-right:8px}
  .title{font-size:22px;margin:6px 0 12px}
  .pill{display:inline-block;margin:6px 6px 0 0;padding:6px 10px;border-radius:999px;background:rgba(255,255,255,.08);}

</style>
</head>
<body>
<div class="bg grid stars"></div>
<div class="wrap">
  <header>
    <div class="dot"></div>
    <h1>2035 æœªæ¥å‡ºè¡Œ</h1>
  </header>
  <div class="progress"><div id="bar" class="bar"></div></div>

  <div id="panel" class="card">
    <div id="qtext" class="q">è¿æ¥æœªæ¥å‡ºè¡Œæ„è¯†ä¸­â€¦</div>
    <div id="hint" class="hint"></div>
    <div id="opts" class="options"></div>
    <div class="actions">
      <button class="btn" id="prevBtn" onclick="prev()" style="display:none">ä¸Šä¸€æ­¥</button>
      <button class="btn primary" id="nextBtn" onclick="next()">ç»§ç»­</button>
    </div>
  </div>

  <div id="result" style="display:none" class="card-result"></div>

  <div class="foot"><span class="muted">é£æ ¼ï¼šCalm Sciâ€‘Fi Ã— HUDï½œæ•°æ®äº‘ï¼šSupabase</span></div>
</div>

<!-- Supabase SDK -->
<script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js"></script>
<!-- html2canvas ç”¨äºå¯¼å‡ºå¡ç‰‡å›¾åƒï¼ˆå¯é€‰ï¼‰ -->
<script src="https://cdn.jsdelivr.net/npm/html2canvas@1.4.1/dist/html2canvas.min.js"></script>
<script>
/***** 1) æ›¿æ¢ä¸ºä½ çš„ Supabase å‡­æ® *****/
const SUPABASE_URL = "https://xrsthdmcujustsezwaln.supabase.co"; // â† å¿…å¡«
const SUPABASE_KEY = "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Inhyc3RoZG1jdWp1c3RzZXp3YWxuIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjE3NzkxMzAsImV4cCI6MjA3NzM1NTEzMH0.i3iGszKjV6UAnG9HpT7o9p83QMT84z2GJ1V5fDawdD0"; // â† å¿…å¡«
// localStorage æ£€æŸ¥
(function(){
  let allowRecord = true;
  let stored = localStorage.getItem('answered');
  if (stored === 'yes') {
    const msg = "æ£€æµ‹åˆ°ä½ å·²æäº¤è¿‡é—®å·ã€‚\n\né€‰æ‹©ï¼š\nã€ç¡®å®šã€‘è¦†ç›–æ—§è®°å½•é‡æ–°æäº¤\nã€å–æ¶ˆã€‘ä»…ä½“éªŒï¼Œä¸è®°å½•æ•°æ®";
    if (confirm(msg)) {
      localStorage.removeItem('answered');
      allowRecord = true;
    } else {
      allowRecord = false;
      window.skipLog = true;
    }
  }
  window.allowRecord = allowRecord;
})();
const sb = (SUPABASE_URL && SUPABASE_KEY && window.supabase) ? supabase.createClient(SUPABASE_URL, SUPABASE_KEY) : null;('survey_done');
const sb = (SUPABASE_URL && SUPABASE_KEY && window.supabase) ? supabase.createClient(SUPABASE_URL, SUPABASE_KEY) : null;

/***** 2) é¢˜åº“ï¼ˆæ¥è‡ªä½ çš„åŸé—®å·ï¼Œè·¯çº¿ D æ–‡æ¡ˆï¼‰ *****/
// type: 'single' å•é€‰ï½œ'multi' å¤šé€‰ï¼ˆmax å¯é€‰ä¸ªæ•°ï¼‰ï½œ'likert' äº”çº§
const quiz = [
  { key:'age_group', type:'single', q:'2035 Â· ä½ å°†å¤„äºå“ªæ®µäººç”Ÿèƒ½é‡å‘¨æœŸï¼Ÿ', hint:'ç”¨äºç”Ÿæˆâ€œç§»åŠ¨ä½“è´£ä»»æŒ‡æ•°â€', opts:[
    ['â‰¤25ï½œæ¢ç´¢ä¸çªç ´', {C:0.5,S:0.3}],
    ['26â€“35ï½œæ•ˆç‡/æˆé•¿', {D:0.6,L:0.2}],
    ['36â€“45ï½œå®¶åº­Ã—äº‹ä¸šå¹³è¡¡', {S:0.4,I:0.3}],
    ['46â€“55ï½œç¨³å¥æ‹“å±•', {L:0.4}],
    ['56â€“65ï½œèˆ’é€‚é•¿ç¨‹', {S:0.5}],
    ['â‰¥66ï½œé™ªä¼´ä¸å¥åº·', {S:0.6}]
  ]},
  { key:'city_tier', type:'single', q:'ä½ æ‰€å¤„çš„åŸå¸‚â€œé¢‘ç‡â€æ˜¯ï¼Ÿ', hint:'ç”¨äºåŸå¸‚ç”Ÿæ€å¤æ‚åº¦å»ºæ¨¡', opts:[
    ['è¶…çº§æ¢çº½ï¼ˆç‰¹å¤§/ä¸€çº¿ï¼‰', {D:0.3,T:0.2}],
    ['é«˜é€Ÿå¢é•¿ä½“ï¼ˆæ–°ä¸€çº¿/çœä¼šï¼‰', {D:0.2}],
    ['åŸå¸‚ä¸ç¤¾åŒºå¸¦ï¼ˆåœ°çº§ï¼‰', {C:0.2}],
    ['å®œå±…å°åŸ/å¿åŸŸ', {S:0.2}],
    ['è‡ªç„¶å…±ç”Ÿç½‘ç»œï¼ˆä¹¡é•‡/ä¹¡é‡ï¼‰', {S:0.3}]
  ]},
  { key:'family', type:'single', q:'ä½ å°†ä¸æ€æ ·çš„â€œç”Ÿå‘½ç¼–é˜Ÿâ€åŒè¡Œï¼Ÿ', hint:'æ¨æ–­èˆ±ä½ä¸ç©ºé—´éœ€æ±‚', opts:[
    ['å•äººèŠ‚ç‚¹', {I:0.6}],
    ['äºŒäººåå¥', {I:0.3}],
    ['æ ¸å¿ƒå®¶åº­', {Sh:0.5}],
    ['å¤šä»£å…±ç”Ÿ', {Sh:0.7}],
    ['å…¶ä»–/åŠ¨æ€ç»“æ„', {}]
  ]},
  { key:'purpose', type:'multi', max:3, q:'ä½ çš„è¡ŒåŠ¨â€œä¸»ç›®çš„â€æ˜¯ï¼Ÿï¼ˆå¯å¤šé€‰ï¼‰', hint:'å¤šé€‰è‡³å¤š 3 é¡¹', opts:[
    ['é€šå‹¤é€šè·¯', {D:0.4}],
    ['å®¶åº­é™ªä¼´ä¸ç…§æŠ¤', {S:0.4,Sh:0.3}],
    ['å•†åŠ¡åˆ‡æ¢', {D:0.5,L:0.3}],
    ['ç”Ÿæ´»æµ/åŸå¸‚æ¼«æ¸¸', {S:0.3,C:0.3}],
    ['åŸé™…/è¿œè¡Œ', {D:0.3}],
    ['ç§»åŠ¨åŠå…¬/åˆ›ä½œç©ºé—´', {L:0.4}],
    ['å…¶ä»–', {}]
  ]},
  { key:'daily_km', type:'single', q:'ä½ çš„æ—¥å¸¸è¡ŒåŠ¨åŠå¾„ï¼Ÿ', hint:'ä¼°ç®—èƒ½é‡ç³»ç»Ÿä¸è¡¥èƒ½é¢‘ç‡', opts:[
    ['0â€“30km', {C:0.2}], ['31â€“60km', {C:0.1}], ['61â€“100km', {D:0.2}], ['101â€“150km', {D:0.3}], ['150km+', {D:0.4}]
  ]},
  { key:'time_slot', type:'single', q:'ä½ çš„æ—¶é—´èŠ‚å¥æ›´åå‘ï¼Ÿ', hint:'è¿è¡Œçª—å£', opts:[
    ['æ¸…æ™¨å¯åŠ¨', {C:0.2}], ['ç™½æ—¥æµåŠ¨', {}], ['é«˜å³°èŠ‚ç‚¹ç©¿æ¢­', {D:0.2}], ['å¤œè¡Œè€…èŠ‚å¥', {S:0.2}], ['ä¸å®š/å¤šæ—¶æ®µ', {D:0.1}]
  ]},
  { key:'freq', type:'single', q:'ä½ çš„è¡ŒåŠ¨é¢‘ç‡æ˜¯ï¼Ÿ', hint:'è¿è¥é¢‘åº¦', opts:[
    ['è½»é¢‘ç‡', {C:0.2}], ['ç¨³å®šå¾ªç¯', {}], ['é«˜é¢‘å¤šèŠ‚ç‚¹', {D:0.3}], ['éšæœºä¸çµæ„Ÿ', {S:0.2}]
  ]},
  { key:'pt_satisfy', type:'likert', q:'æœªæ¥ï¼Œä½ æ„¿è®©å…¬å…±/å…±äº«ç³»ç»Ÿæ‰¿æ‹…å¤šå°‘è¡ŒåŠ¨ï¼Ÿ', hint:'1=ä»…å¤‡é€‰ï¼Œ5=å…¨äº¤ä»˜', opts:['1','2','3','4','5'] },
  { key:'form', type:'single', q:'ä½ æ„¿ä½ çš„ç§»åŠ¨ä½“ä»¥æ€æ ·çš„å­˜åœ¨æ–¹å¼é™ªä¼´ä½ ï¼Ÿ', hint:'å†³å®šå½¢æ€ä¸å¿ƒæ™º', opts:[
    ['è¿›åŒ–åº§èˆ±/èƒ½é‡ä½“', {D:0.4,L:0.3}],
    ['ä»¿ç”Ÿå…±ç”Ÿä½“', {S:0.5}],
    ['æµåŠ¨ç©ºé—´', {C:0.4}],
    ['ç¥ç»æ—…ç¨‹é€šé“', {S:0.4}],
    ['æ··åˆ/è‡ªå®šä¹‰', {S:0.2,D:0.2}]
  ]},
  { key:'autonomy', type:'single', q:'ä½ æ„¿æ„äº¤ä»˜å¤šå°‘è¡ŒåŠ¨è‡ªä¸»æƒï¼Ÿ', hint:'è‡ªåŠ¨é©¾é©¶æ¥å—åº¦', opts:[
    ['æˆ‘ä¸»é©¾', {Ctrl:0.6}],
    ['ä¸»é©¾+AIè¾…åŠ©', {Ctrl:0.3,T:0.2}],
    ['AIä¸»é©¾+æˆ‘ç›‘ç®¡', {T:0.4}],
    ['å®Œå…¨è‡ªåŠ¨/æ— æ–¹å‘ç›˜', {T:0.7}],
    ['æ„è¯†é©¾é©¶/èåˆæ§åˆ¶', {T:0.5,S:0.2}]
  ]},
  { key:'in_cabin', type:'single', q:'è¿è¡Œæ—¶ï¼Œä½ çš„â€œä¸»çŠ¶æ€â€ï¼Ÿ', hint:'èˆ±å†…æ¨¡å¼åå¥½', opts:[
    ['ä¼‘æ¯ä¸ç–—æ„ˆ', {S:0.4}],
    ['æ²‰æµ¸å¨±ä¹', {S:0.3}],
    ['é«˜æ•ˆå·¥ä½œ/å­¦ä¹ ', {L:0.5}],
    ['å†¥æƒ³/ç²¾ç¥æµåŠ¨', {S:0.5,C:0.2}],
    ['ç¤¾äº¤å¯¹è¯', {Sh:0.3}]
  ]},
  { key:'features', type:'multi', max:4, q:'ä½ å¸Œæœ›èˆ±å†…ä¼˜å…ˆå¼ºåŒ–å“ªäº›â€œèƒ½åŠ›â€ï¼Ÿï¼ˆå¤šé€‰â‰¤4ï¼‰', hint:'åŠŸèƒ½åå¥½', opts:[
    ['AI æ·±åº¦åŠ©æ‰‹', {L:0.3}],
    ['èˆ’é€‚åº§èˆ±/åº§æ¤…AI', {S:0.2}],
    ['å£°åœº/æ°›å›´', {S:0.3}],
    ['å¥åº·/æƒ…ç»ªç›‘æµ‹', {S:0.2}],
    ['äº’è”/å¯¼èˆª/V2X', {L:0.3}],
    ['å˜å½¢ç©ºé—´/æ”¶çº³', {L:0.2}],
    ['æˆ·å¤–/éœ²è¥æ¨¡å—', {S:0.2}],
    ['å…¶ä»–', {}]
  ]},
  { key:'ota', type:'single', q:'OTAï¼ˆè¿›åŒ–å‡çº§ï¼Œå³è½¦è¾†åƒæ‰‹æœºä¸€æ ·è‡ªåŠ¨æ›´æ–°ï¼‰å¯¹ä½ é‡è¦å—ï¼Ÿ', hint:'è¿›åŒ–æœŸæœ›', opts:[
    ['æ— éœ€æ›´æ–°', {C:0.2}], ['å¯é€‰å‡çº§', {}], ['å®šæœŸæ›´æ–°', {L:0.2}], ['é«˜åº¦ä¾èµ–æ›´æ–°', {L:0.4}], ['æœŸå¾…æŒç»­è‡ªæˆ‘è¿›åŒ–', {L:0.6}]
  ]},
  { key:'open', type:'single', q:'ç”¨ä¸€å¥è¯æè¿°ä½ å¿ƒä¸­çš„ 2035 å®Œç¾ç§»åŠ¨ä½“ã€‚', hint:'å¼€æ”¾é¢˜ï¼ˆå¯ç•¥è¿‡ï¼‰', opts:[['ï¼ˆç•¥è¿‡ï¼‰',{}]]}
];

/***** 3) è¿è¡Œæ€ *****/
let i = -1; // å½“å‰é¢˜ç´¢å¼•
const answers = {}; // key -> value or array
const traits = {C:0,D:0,S:0,L:0,T:0,Ctrl:0,I:0,Sh:0}; // Calm/Driven/Soul/Logic/Trust/Control/Individual/Shared

const qEl = document.getElementById('qtext');
const hintEl = document.getElementById('hint');
const optsEl = document.getElementById('opts');
const nextBtn = document.getElementById('nextBtn');
const prevBtn = document.getElementById('prevBtn');
const barEl = document.getElementById('bar');
const resultEl = document.getElementById('result');

function start(){ next(); }

function prev(){ if(i<=0){return} i--; render(); }
function next(){ i++; if(i>=quiz.length){ finish(); return;} render(); }

function render(){
  prevBtn.style.display = i>0? 'inline-flex':'none';
  const p = (i/quiz.length*100).toFixed(1); barEl.style.width = p+'%';
  const q = quiz[i];
  qEl.textContent = q.q; hintEl.textContent = q.hint||'';
  nextBtn.style.display = (q.type==='single'||q.type==='likert')? 'none':'inline-flex';
  // ç”Ÿæˆé€‰é¡¹
  optsEl.innerHTML = '';
  if(q.type==='single'){
    (q.opts).forEach(([label,vec])=>{
      const div = document.createElement('div'); div.className='chip'; div.textContent = label;
      div.onclick = ()=>{ chooseSingle(q, label, vec) };
      optsEl.appendChild(div);
    })
  } else if(q.type==='multi'){
    const max = q.max || 99; const selected = new Set(answers[q.key]||[]);
    q.opts.forEach(([label,vec])=>{
      const div = document.createElement('div'); div.className='chip'; div.textContent=label; if(selected.has(label)) div.classList.add('sel');
      div.onclick = ()=>{
        if(selected.has(label)){ selected.delete(label); div.classList.remove('sel'); }
        else { if(selected.size>=max){ alert(`æœ€å¤šå¯é€‰ ${max} é¡¹`); return;} selected.add(label); div.classList.add('sel'); }
        answers[q.key] = Array.from(selected);
      };
      optsEl.appendChild(div);
    });
    nextBtn.onclick = ()=>{ // ç»Ÿè®¡å‘é‡å¹¶æäº¤ï¼ˆæŒ‰å¹³å‡è®°åˆ†ï¼‰
      const picked = answers[q.key]||[]; if(picked.length===0){ alert('è¯·è‡³å°‘é€‰æ‹© 1 é¡¹'); return; }
      picked.forEach(label=>{ const vec = (q.opts.find(o=>o[0]===label)||[])[1]||{}; addVec(vec); logStep(q.q, label); });
      next();
    }
  } else if(q.type==='likert'){
    const wrap = document.createElement('div'); wrap.style.display='flex'; wrap.style.gap='10px';
    q.opts.forEach(v=>{
      const b = document.createElement('button'); b.className='btn'; b.textContent=v; b.onclick=()=>{ answers[q.key]=v; addVec({T:(+v-3)*0.15}); logStep(q.q, v); next(); };
      wrap.appendChild(b);
    });
    optsEl.appendChild(wrap);
  }
}

function chooseSingle(q, label, vec){
  answers[q.key] = label; addVec(vec||{}); logStep(q.q, label); next();
}

function addVec(vec){ for(const k in vec){ traits[k] = (traits[k]||0) + vec[k]; } }

async function logStep(step, answer){
  // æœ¬åœ°å·²å¡«è¿‡åˆ™ä¸è®°å½•
  if(!allowRecord) return;
  if(!sb) return;(step, answer){
  if(!sb) return; // æœ¬åœ°è°ƒè¯•å¯ç”¨
  try{
    await sb.from('answers').insert({ step, answer, time:new Date().toISOString() });
  }catch(e){ console.log('log step err',e); }
}

function finish(){
  // é¦–æ¬¡ä½œç­”æ ‡è®°
  if(allowRecord){ localStorage.setItem('survey_done','1'); }
  document.getElementById('panel').style.display='none';(){
  document.getElementById('panel').style.display='none';
  document.getElementById('result').style.display='block';
  const persona = computePersona(traits);
  resultEl.innerHTML = renderCard(persona);
}

function computePersona(t){
  // ç»´åº¦å¯¹æ¯”
  const axis = {
    pace: t.D - t.C, // æ­£=é©±åŠ¨ è´Ÿ=å®é™
    mind: t.S - t.L, // æ­£=çµé­‚ è´Ÿ=ç†æ€§
    trust: t.T - (t.Ctrl||0), // æ­£=ä¿¡ä»»AI è´Ÿ=åäººæ§
    social: (t.Sh||0) - (t.I||0) // æ­£=å…±äº« è´Ÿ=ä¸ªä½“
  };
  // ç±»å‹å‘½åï¼ˆA+B æ··åˆé£æ ¼ï¼‰
  let name = '';
  if(axis.pace<=0 && axis.mind>=0) name = 'é™åŸŸæ¼«è¡Œè€… Â· Î±';
  else if(axis.pace>0 && axis.mind<0) name = 'é€ŸåŸŸæ‰§è¡Œè€… Â· R';
  else if(axis.mind>=0 && axis.trust>0.2) name = 'å¿ƒæµå…±é¸£ä½“ Â· S';
  else name = 'å‡è¡¡å¯¼èˆªè€… Â· N';

  // å»ºè®®è½½å…·
  let vehicle = 'å¿ƒæµé™åŸŸèˆ±';
  if(axis.pace>0.3 && axis.mind<0) vehicle='BladePilot é«˜é€Ÿè‡ªä¸»èˆ±';
  else if(axis.mind>0.3) vehicle='ä»¿ç”Ÿå…±ç”Ÿä½“ Â· ä¼´è¡Œæ¨¡å¼';
  else if(Math.abs(axis.social)>0.3 && axis.social>0) vehicle='å…±äº«èƒ¶å›Šç½‘ Â· ç¼–é˜Ÿæ¨¡å¼';

  // å…³é”®è¯
  const tags = [];
  tags.push(axis.pace>0?'é©±åŠ¨':'å®é™');
  tags.push(axis.mind>0?'æ„Ÿæ€§':'ç†æ€§');
  tags.push(axis.trust>0?'ä¿¡ä»»AI':'äººæ§åå¥½');
  tags.push(axis.social>0?'å…±äº«ååŒ':'ä¸ªä½“ä¸»å¯¼');

  return { name, vehicle, tags, axis, detail: t, answers };
}

function renderCard(p){
  return `
    <div class="badge">AI Persona</div>
    <div class="badge">2035</div>
    <div class="title">ä½ æ˜¯ï¼š<b>${p.name}</b></div>
    <div style="margin:8px 0 14px;opacity:.8">æ¨èç§»åŠ¨ä½“ï¼š<b>${p.vehicle}</b></div>
    <div>
      ${p.tags.map(x=>`<span class="pill">${x}</span>`).join('')}
    </div>
    <div style="margin-top:14px;opacity:.8;font-size:13px">ä½ å¯é•¿æŒ‰ä¿å­˜æˆ–ç‚¹å‡»å¯¼å‡ºå›¾ç‰‡ã€‚</div>
    <div class="actions" style="margin-top:12px">
      <button class="btn" onclick="exportCard()">å¯¼å‡ºå¡ç‰‡å›¾ç‰‡</button>
      <button class="btn" onclick="restart()">é‡æ–°ä½œç­”</button>
    </div>
  `;
}

function restart(){ location.reload(); }

async function exportCard(){
  const node = document.getElementById('result');
  const canvas = await html2canvas(node,{backgroundColor:'#0b1220',scale:2});
  const link = document.createElement('a');
  link.download = 'future-persona-card.png';
  link.href = canvas.toDataURL('image/png');
  link.click();
}

// localStorage æ£€æŸ¥
(function(){
  let allowRecord = true;
  let stored = localStorage.getItem('answered');
  if (stored === 'yes') {
    const msg = "æ£€æµ‹åˆ°ä½ å·²æäº¤è¿‡é—®å·ã€‚

é€‰æ‹©ï¼š
ã€ç¡®å®šã€‘è¦†ç›–æ—§è®°å½•é‡æ–°æäº¤
ã€å–æ¶ˆã€‘ä»…ä½“éªŒï¼Œä¸è®°å½•æ•°æ®";
    if (confirm(msg)) {
      localStorage.removeItem('answered');
      allowRecord = true;
    } else {
      allowRecord = false;
      window.skipLog = true;
    }
  }
  window.allowRecord = allowRecord;
})();
// å¯åŠ¨
// å¦‚æœå·²å¡«è¿‡ï¼Œæç¤ºç”¨æˆ·
if(!allowRecord){
  setTimeout(()=>alert('ç³»ç»Ÿæ£€æµ‹åˆ°ä½ å·²æäº¤è¿‡ä¸€æ¬¡ï¼Œæœ¬æ¬¡å›ç­”ä¸ä¼šè¢«è®°å½•ï¼Œå°½æƒ…ä½“éªŒå§ï¼ğŸ§'),1200);
}
setTimeout(start, 600);
</script>
</body>
</html>
