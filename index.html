<!DOCTYPE html>
<html lang="zh-CN">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>2035 æœªæ¥å‡ºè¡Œ</title>
<style>
  :root{
    --bg-dark:#070b14;
    --hud:#00ffd0;
    --hud2:#5edfff;
    --card:#0e1626;
    --text:#e6f7ff;
    --muted:#7d9fb5;
  }
  *{box-sizing:border-box;margin:0;padding:0;font-family:-apple-system,BlinkMacSystemFont,Segoe UI,Roboto}
  body{
    background:radial-gradient(800px 600px at 50% 20%,#101a2e,#05070d);
    color:var(--text);
    overflow-x:hidden;
  }
  /* HUD æ˜Ÿç©ºç²’å­ */
  .stars{position:fixed;inset:0;z-index:-2;background:transparent;pointer-events:none}
  .stars::before,.stars::after{
    content:"";position:absolute;inset:0;background-image:radial-gradient(2px 2px at 20% 30%,rgba(255,255,255,.5),transparent),radial-gradient(1.5px 1.5px at 80% 60%,rgba(255,255,255,.4),transparent),radial-gradient(1.2px 1.2px at 40% 80%,rgba(255,255,255,.35),transparent);
    animation:twinkle 6s infinite linear;
  }
  @keyframes twinkle{0%{opacity:.8}50%{opacity:.25}100%{opacity:.8}}
  /* HUD ç½‘æ ¼ */
  .grid::before{content:"";position:fixed;inset:0;z-index:-3;background-image:linear-gradient(rgba(0,255,208,.05) 1px,transparent 1px),linear-gradient(90deg,rgba(0,255,208,.05) 1px,transparent 1px);background-size:40px 40px;opacity:.4;filter:blur(.4px)}

  .wrap{max-width:560px;margin:0 auto;padding:32px 20px 100px}
  header{display:flex;align-items:center;gap:10px;margin-bottom:18px}
  .dot{width:10px;height:10px;border-radius:50%;background:var(--hud);box-shadow:0 0 12px var(--hud)}
  h1{font-size:22px;font-weight:700}

  .card{background:var(--card);border:1px solid rgba(0,255,208,.1);border-radius:18px;padding:20px;margin-top:16px;box-shadow:0 8px 20px rgba(0,0,0,.35)}
  .q{font-size:18px;line-height:1.6;margin-bottom:14px}
  .hint{font-size:13px;color:var(--muted);margin-bottom:14px}

  .chip{padding:12px 14px;border:1px solid rgba(255,255,255,.1);border-radius:12px;background:rgba(255,255,255,.02);cursor:pointer;margin-bottom:10px;transition:.2s}
  .chip:hover{border-color:var(--hud);background:rgba(0,255,208,.07)}
  .chip.sel{border-color:var(--hud);background:rgba(0,255,208,.18);box-shadow:0 0 12px rgba(0,255,208,.2)}

  .actions{display:flex;gap:10px;margin-top:14px}
  .btn{padding:12px 16px;border-radius:12px;border:1px solid rgba(255,255,255,.1);background:rgba(255,255,255,.05);cursor:pointer;color:var(--text)}
  .btn.primary{border-color:var(--hud);background:linear-gradient(180deg,rgba(0,255,208,.25),rgba(0,255,208,.05))}

  .progress{height:6px;background:#1a2738;border-radius:999px;overflow:hidden;margin:12px 0 8px}
  .bar{height:100%;background:linear-gradient(90deg,var(--hud),var(--hud2));width:0%;transition:width .25s ease}

  /* ç»“æœå¡ */
  .result-card{background:rgba(0,0,0,.45);backdrop-filter:blur(12px);border:1px solid rgba(0,255,208,.3);border-radius:18px;padding:20px;margin-top:20px}
</style>
</head>
<body>
<div class="stars"></div>
<div class="grid"></div>
<div class="wrap">
  <header><div class="dot"></div><h1>2035 æœªæ¥å‡ºè¡Œ</h1></header>
  <div class="progress"><div id="bar" class="bar"></div></div>
  <div id="panel" class="card">
    <div id="qtext" class="q"></div>
    <div id="hint" class="hint"></div>
    <div id="opts"></div>
    <div class="actions">
      <button class="btn" id="prevBtn" onclick="prev()" style="display:none">ä¸Šä¸€æ­¥</button>
      <button class="btn primary" id="nextBtn" onclick="next()">ç»§ç»­</button>
    </div>
  </div>
  <div id="result" class="result-card" style="display:none"></div>
</div>

<script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js"></script>
<script>
const SUPABASE_URL = "https://xrsthdmcujustsezwaln.supabase.co";
const SUPABASE_KEY = "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Inhyc3RoZG1jdWp1c3RzZXp3YWxuIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjE3NzkxMzAsImV4cCI6MjA3NzM1NTEzMH0.i3iGszKjV6UAnG9HpT7o9p83QMT84z2GJ1V5fDawdD0";
const sb = supabase.createClient(SUPABASE_URL, SUPABASE_KEY);

let stored = localStorage.getItem("survey_done");
let allowRecord = !stored;
if(stored){
  if(confirm("ä½ å·²ç»å¡«å†™è¿‡ä¸€æ¬¡é—®å·\n\nç¡®å®š = è¦†ç›–æ—§è®°å½•\nå–æ¶ˆ = æœ¬æ¬¡ä¸è®°å½•ï¼Œä»…ä½“éªŒ")){
    localStorage.removeItem("survey_done");
    allowRecord = true;
  } else allowRecord = false;
}

// ç®€åŒ–é—®é¢˜é›†ï¼ˆç¤ºä¾‹ï¼‰
const quiz=[
 {key:'age',type:'single',q:'2035 Â· ä½ å°†å¤„äºå“ªæ®µäººç”Ÿèƒ½é‡å‘¨æœŸï¼Ÿ',hint:'ç”¨äºè´£ä»»æŒ‡æ•°',opts:['â‰¤25','26â€“35','36â€“45','46â€“55','56â€“65','â‰¥66']},
 {key:'city',type:'single',q:'ä½ æ‰€åœ¨çš„åŸå¸‚ç±»å‹æ˜¯ï¼Ÿ',hint:'ç”Ÿæ€å¤æ‚åº¦',opts:['ä¸€çº¿','æ–°ä¸€çº¿/çœä¼š','åœ°çº§å¸‚','å¿åŸ','ä¹¡é•‡']},
 {key:'freq',type:'single',q:'ä½ çš„å‡ºè¡Œé¢‘ç‡æ˜¯ï¼Ÿ',hint:'è¡ŒåŠ¨èŠ‚å¥',opts:['ä½é¢‘','ç¨³å®š','é«˜é¢‘','éšæœºçµæ„Ÿ']},
 {key:'form',type:'single',q:'æœªæ¥ä½ æœŸæœ›çš„å‡ºè¡Œå½¢æ€ï¼Ÿ',hint:'è½½å…·å½¢æ€',opts:['èƒ¶å›Šè½¦','ä»¿ç”Ÿä¼´è¡Œ','ç©ºé—´æµåŠ¨','ç¥ç»æ—…ç¨‹','æ··åˆæ¨¡å¼']},
];

let i=-1;const answers={};
const qEl=document.getElementById('qtext');const hintEl=document.getElementById('hint');const optsEl=document.getElementById('opts');const barEl=document.getElementById('bar');const panel=document.getElementById('panel');const res=document.getElementById('result');

function prev(){if(i<=0)return;i--;render();}
function next(){i++;if(i>=quiz.length)return finish();render();}

function render(){
 document.getElementById('prevBtn').style.display=i>0?'inline-flex':'none';
 barEl.style.width=(i/quiz.length*100)+"%";
 const q=quiz[i];qEl.textContent=q.q;hintEl.textContent=q.hint;optsEl.innerHTML="";
 q.opts.forEach(opt=>{
  const d=document.createElement('div');d.className='chip';d.textContent=opt;
  d.onclick=()=>{answers[q.key]=opt;log(q.q,opt);next();};
  optsEl.appendChild(d);
 });
}

async function log(step,ans){
 if(!allowRecord)return;
 await sb.from('answers').insert({step,answer:ans,time:new Date().toISOString()});
}

function finish(){
 panel.style.display='none';res.style.display='block';
 localStorage.setItem('survey_done','1');
 res.innerHTML=`âœ… å·²å®Œæˆï¼<br><br>æ„Ÿè°¢ä½ å‚ä¸æœªæ¥å‡ºè¡Œå…±åˆ› ğŸŒŒ`;
}

next();
</script>
</body></html>
